"use strict";(self.webpackChunk_grammarly_denali_app=self.webpackChunk_grammarly_denali_app||[]).push([[9501],{67804:(e,t,i)=>{i.d(t,{RG:()=>f,nF:()=>n,xg:()=>s});var s,n,a=i(23988),o=i(10334),r=i(17171),l=i(45819),c=i(38886),d=i(66202),u=i(65390),m=i(94855),p=i(84647),h=i(71301),g=i(90829),_=i(88607);!function(e){e.Monthly="Monthly",e.Quarterly="Quarterly",e.Annual="Annual"}(s||(s={})),function(e){const t=c.TS({annual:u.none,quarterly:u.none,monthly:u.none},((e,t)=>{switch(t.periodMonths){case 1:return(0,r._)((0,o._)({},e),{monthly:u.some(t)});case 3:return(0,r._)((0,o._)({},e),{quarterly:u.some(t)});case 12:return(0,r._)((0,o._)({},e),{annual:u.some(t)});default:return e}}));function i(e,t){return{pricePerYear:{value:e-t.value,currency:t.currency},percent:`${Math.round(100*(e-t.value)/e)}%`}}e.createOfferBasedOnAnnual=(0,p.flow)(t,(0,l.Jq)(u.Applicative),u.map((({annual:e,quarterly:t,monthly:s})=>({price:e.priceMoney,regularPrice:e.regularPriceMoney,discountPercent:"0%",periodInMonths:12,title:"Annual",savePricedBySwitchingFrom:{monthly:i(12*s.priceMoney.value,e.priceMoney),quarterly:i(4*t.priceMoney.value,e.priceMoney)}}))))}(n||(n={}));class f{get isMonthly(){return 1===this.currentPlan.periodMonths}get isQuarterly(){return 3===this.currentPlan.periodMonths}get savedPrice(){return this.isMonthly?this.offer.savePricedBySwitchingFrom.monthly:this.offer.savePricedBySwitchingFrom.quarterly}get currentPlanType(){return this.isMonthly?s.Monthly:this.isQuarterly?s.Quarterly:s.Annual}get daysToRenewal(){const e=this.nextPaymentDate.getTime(),t=h.Yr.now().getTime();return Math.floor(Math.max(0,e-t)/h.ei)}get shouldShowOffer(){return!!f.enableDebugModeToShowOffer||this.willSubscriptionRenewSoon&&!this.hasAlreadyChangedToAnnual&&!this._isOnTrial&&!this._appleOrGoogleSubscription}get hasAlreadyChangedToAnnual(){return(0,p.pipe)(this._queuedPlan,u.exists((({periodMonths:e})=>12===e)))}get willSubscriptionRenewSoon(){const e=this.daysToRenewal<2*h.f9;return(this.isMonthly||this.isQuarterly)&&e}static create({currentPlan:e,queuedPlan:t,nextPayDate:i,expirationDate:s,isCancelled:a,plans:o,isOnTrial:r,isAppleSubscription:l,isGooglePlaySubscription:c},m){if(null==e)return d.left("Cannot load plans for change plan when user is freemium");if(!i&&!s)return d.left("Cannot change plan when nextPayDate and expirationDate are null");const h={renew:()=>m.renew(),changePlan:e=>m.changePlan(e),getPlans:()=>m.getPlans()},g=n.createOfferBasedOnAnnual(o);return(0,p.pipe)(g,d.fromOption((()=>"Cannot create offer, plans are incomplete, monthly or quarterly or annual are not presented in subscription status")),d.map((n=>new f(n,e,new Date(null!=i?i:s),null!=a&&a,null!=r&&r,u.fromNullable(t),h,l||c||!1))))}constructor(e,t,i,s,n,o,r,l){(0,a._)(this,"offer",void 0),(0,a._)(this,"currentPlan",void 0),(0,a._)(this,"nextPaymentDate",void 0),(0,a._)(this,"_isCancelled",void 0),(0,a._)(this,"_isOnTrial",void 0),(0,a._)(this,"_queuedPlan",void 0),(0,a._)(this,"_subscriptionOps",void 0),(0,a._)(this,"_appleOrGoogleSubscription",void 0),(0,a._)(this,"_renew",void 0),(0,a._)(this,"_getPlans",void 0),(0,a._)(this,"_changePlan",void 0),(0,a._)(this,"_extractAnnualPlan",void 0),(0,a._)(this,"changePlan",void 0),this.offer=e,this.currentPlan=t,this.nextPaymentDate=i,this._isCancelled=s,this._isOnTrial=n,this._queuedPlan=o,this._subscriptionOps=r,this._appleOrGoogleSubscription=l,this._renew=e=>m.TX((()=>!0===e?this._subscriptionOps.renew():Promise.resolve()),(e=>({reason:"Renew failed",originalError:e}))),this._getPlans=()=>m.TX((()=>this._subscriptionOps.getPlans()),(e=>({reason:"Could not get plans",originalError:e}))),this._changePlan=e=>m.TX((()=>this._subscriptionOps.changePlan(e)),(e=>({reason:"Changing plan failed",originalError:e}))),this._extractAnnualPlan=(0,p.flow)(c.i8((e=>12===e.periodMonths)),d.fromOption((()=>({reason:"Expectation failed, we did not receive the annual plan"}))),d.filterOrElse((e=>_.v0.eq.equals(e.priceMoney,this.offer.price)),(()=>({reason:"Expectation failed, we did not receive the annual plan with offered price"}))),d.map((e=>e.id)),m.Mr),this.changePlan=(0,p.pipe)(this._renew(this._isCancelled),m.cy(this._getPlans),m.cy(this._extractAnnualPlan),m.cy(this._changePlan)),(0,g.hJ)("changePlanHookShowOffer",(()=>f.enableDebugModeToShowOffer=!0))}}(0,a._)(f,"enableDebugModeToShowOffer",!1)},12495:(e,t,i)=>{i.d(t,{L:()=>m,N:()=>s});var s,n=i(83531),a=i(23988),o=i(84647),r=i(84712),l=i(91745),c=i(25093),d=i(79937),u=i(48779);class m{enable(){return this._isEnabled.set(!0),this._enable(),()=>{this._isEnabled.set(!1),this._disable()}}recheck(){var e=this;return(0,n._)((function*(){const t=!e._isEnabled.get();t&&e._enable(),yield e._plagiarismCheckingState.pipe(l.p((e=>"idle"===e)),c.$()).toPromise(),t&&e._plagiarismCapiClient.disablePlagiarismSearch()}))()}dispose(){this._subs.forEach((e=>e.unsubscribe()))}constructor(e,t,i){(0,a._)(this,"_documentModel",void 0),(0,a._)(this,"_events",void 0),(0,a._)(this,"_plagiarismCapiClient",void 0),(0,a._)(this,"_plagiarismCheckingState",void 0),(0,a._)(this,"plagiarismCheckedInSession",void 0),(0,a._)(this,"checkingState",void 0),(0,a._)(this,"_subs",void 0),(0,a._)(this,"_isEnabled",void 0),(0,a._)(this,"_enable",void 0),(0,a._)(this,"_disable",void 0),this._documentModel=e,this._events=t,this._plagiarismCapiClient=i,this._plagiarismCheckingState=this._documentModel.asyncChecksState.lens("plagiarism"),this.plagiarismCheckedInSession=this._plagiarismCheckingState.view((e=>"full"!==e)),this.checkingState=this._plagiarismCheckingState,this._subs=[],this._isEnabled=r.s.create(!1),this._enable=()=>{this._plagiarismCheckingState.modify((e=>"idle"===e?"checking":e)),this._documentModel.extraSettings.checkedPlagiarism=!0,this._plagiarismCapiClient.enablePlagiarismSearch()},this._disable=()=>{this._plagiarismCapiClient.disablePlagiarismSearch()},this._subs.push(this._isEnabled.pipe(d.n(u.vh(this._events.pipe(l.p((e=>"session_started"===e.kind)))))).subscribe(this._enable))}}!function(e){e.Mock=class{constructor(){(0,a._)(this,"enable",(()=>o.constVoid)),(0,a._)(this,"recheck",(()=>new Promise(o.constVoid))),(0,a._)(this,"dispose",o.constVoid),(0,a._)(this,"checkingState",r.s.create("idle")),(0,a._)(this,"plagiarismCheckedInSession",r.s.create(!0))}}}(s||(s={}))},80189:(e,t,i)=>{i.d(t,{YJ:()=>a,Yi:()=>s,y5:()=>b});var s,n,a,o=i(23988),r=i(66202),l=i(65390),c=i(84647),d=i(71301),u=i(84712),m=i(40086),p=i(1224),h=i(68801),g=i(94855),_=i(63687),f=i(7149);!function(e){function t(e){return"sending"===e.kind}e.isSending=t,e.isSendingState=l.exists(t)}(s||(s={})),function(e){e.isSuccess=function(e){return e.status===m.c.StatisticsStatus.Success}}(n||(n={}));class b{getPlans(){return this._doc.getProofitPlans().then(r.fold((e=>Promise.reject(e)),(e=>e.status===m.c.PlanStatus.Forbidden?Promise.reject({status:m.c.PlanStatus.Forbidden}):Promise.resolve(e))))}getStatistics(){return _.v(this._proofitStatisticsIO).pipe(f.T(l.fromEither))}placeOrder(e,t,i,s,n){return this.state.set(l.some({kind:"sending"})),h.hq(this._doc.placeProofitOrder({turnaround:e.turnaround,tier:e.tier,userInputs:t,priceOfferId:i,payWithCredits:n},s)).then((e=>this._updateStatus(e.status))).catch((e=>{p.Bx.Logging.getLogger("ProofitModel").warn("Error placing proofit order",e),this.state.set(l.some({kind:"error",errorType:"unknown"}))}))}updateState(e){this._updateStatus(e.status),this.jobDetails.set(l.some({startTime:e.submitted,dueTime:e.due}))}_updateStatus(e){switch(e){case m.c.JobStatus.building:break;case m.c.JobStatus.newJob:this.state.set(l.some({kind:"submitted"}));break;case m.c.JobStatus.completed:this.state.set(l.some({kind:"finished"}));break;case m.c.JobStatus.cancelled:this.state.set(l.some({kind:"cancelled"}));break;case m.c.JobStatus.emptyDocument:this.state.set(l.some({kind:"error",errorType:"emptyDocument"}));break;case m.c.JobStatus.duplicate:this.state.set(l.some({kind:"error",errorType:"alreadyProofread"}));break;case m.c.JobStatus.complexInternalStructure:this.state.set(l.some({kind:"error",errorType:"complexInternalStructure"}));break;case m.c.JobStatus.paymentError:this.state.set(l.some({kind:"error",errorType:"payment"}));break;case m.c.JobStatus.forbidden:case m.c.JobStatus.unknown:default:this.state.set(l.none)}}constructor(e,t){(0,o._)(this,"_doc",void 0),(0,o._)(this,"documentTitle",void 0),(0,o._)(this,"_statisticsCache",void 0),(0,o._)(this,"_proofitStatisticsIO",void 0),(0,o._)(this,"state",void 0),(0,o._)(this,"jobDetails",void 0),this._doc=e,this.documentTitle=t,this._statisticsCache=l.none,this._proofitStatisticsIO=()=>(0,c.pipe)(this._statisticsCache,l.fold((0,c.pipe)(this._doc.getProofitStatistics,g.cy(g.aN(n.isSuccess,(e=>new Error(e.status)))),g.W6((e=>g.L9((()=>{this._statisticsCache=l.some(e)}))))),(e=>Promise.resolve(r.right(e))))),this.state=u.s.create(l.none),this.jobDetails=u.s.create(l.none)}}!function(e){e.Mock=class extends b{constructor(e=m.c.JobStatus.newJob,t=l.none){var i,s,n;super((i=e,s={status:m.c.StatisticsStatus.Success,lastCompletedJobDate:t},n=e=>{this.updateState(e)},{getProofitPlans:()=>Promise.resolve(r.right({status:m.c.PlanStatus.Success,turnaroundOptions:[{enabled:!0,label:"24 hours",minutesToProcess:l.of(1440),hoursToProcess:l.none,perWord:.14,price:140,turnaround:m.c.PlanType.TwentyFourHours,requirePaymentCheck:!1,tier:m.c.PlanTier.Base,credits:l.none},{enabled:!0,label:"3 hours",minutesToProcess:l.of(180),hoursToProcess:l.none,perWord:.18,price:180,turnaround:m.c.PlanType.ThreeHours,requirePaymentCheck:!0,tier:m.c.PlanTier.Base,credits:l.none},{enabled:!0,label:"30 minutes",minutesToProcess:l.of(30),hoursToProcess:l.none,perWord:.3,price:300,turnaround:m.c.PlanType.Instant,requirePaymentCheck:!1,tier:m.c.PlanTier.Base,credits:l.none}],clarityTurnaroundOptions:[{enabled:!0,label:"24 hours",minutesToProcess:l.of(1440),hoursToProcess:l.none,perWord:.14,price:140,turnaround:m.c.PlanType.TwentyFourHours,requirePaymentCheck:!1,tier:m.c.PlanTier.Clarity,credits:l.none},{enabled:!0,label:"3 hours",minutesToProcess:l.of(180),hoursToProcess:l.none,perWord:.18,price:180,turnaround:m.c.PlanType.ThreeHours,requirePaymentCheck:!0,tier:m.c.PlanTier.Clarity,credits:l.none}],words:100,userInputs:{nativeLanguage:l.none,dialect:l.none,quotationType:l.none,spaceType:l.none,noteToEditor:l.none},priceOfferId:m.c.PriceOfferId.create(424242)})),placeProofitOrder:()=>()=>new Promise((e=>{const t=d.Yr.Timestamp.now(),s=d.Yr.Timestamp.toLocal(d.Yr.Timestamp.add(t,3*d.WU)),a={submitted:d.Yr.Timestamp.toLocal(t),corrections:5,due:s,price:666,name:"",completed:l.none,id:1,status:m.c.stringToJobStatus(i),is_dox_applied:!0};setTimeout((()=>e(r.right(a))),0),setTimeout((()=>n(a)),500)})),getProofitStatistics:()=>Promise.resolve(r.right(s))}),u.s.create(""))}}}(a||(a={}))},5875:(e,t,i)=>{i.d(t,{V:()=>s,Md:()=>V,N$:()=>a,_S:()=>n});var s,n,a,o,r=i(23988),l=i(10334),c=i(17171),d=i(66202),u=i(44869),m=i(84647),p=i(24819),h=i(84712),g=i(89186),_=i(40086),f=i(1224),b=i(65390),v=i(65160),S=i(76005),y=i(2061),w=i(4444),E=i(14553),T=i(25093),x=i(99010),P=i(48779),M=i(91745),C=i(3016),k=i(7149),I=i(79937),O=i(58277),B=i(30343),K=i(9401),H=i(5692),N=i(47456),D=i(81753),A=i(21644),L=i(83694),F=i(5406),$=i(9079),q=i(39812),W=i(34553);class R{_closeProofitOrder(){this._closeModal()}dispose(){this._subscriptions.dispose()}constructor(e){(0,r._)(this,"_closeModal",void 0),(0,r._)(this,"actions",void 0),(0,r._)(this,"_subscriptions",void 0),this._closeModal=e,this.actions=new W.B,this._subscriptions=new C.y.Keeper,this._subscriptions.push(this.actions.subscribe((()=>this._closeProofitOrder())))}}class U{toggleActive(e){return this.active.set(e),this}isRecommended(e){const t=Object.values(_.c.PlanType);return this===[...e].filter((e=>e.details.tier===this.details.tier)).reduce(((e,i)=>t.indexOf(i.details.turnaround)<t.indexOf(e.details.turnaround)?i:e))&&this.details.enabled}constructor(e,t){(0,r._)(this,"details",void 0),(0,r._)(this,"_ops",void 0),(0,r._)(this,"active",void 0),(0,r._)(this,"select",void 0),(0,r._)(this,"unselect",void 0),(0,r._)(this,"placeOrder",void 0),this.details=e,this._ops=t,this.active=h.s.create(!1),this.select=()=>{this._ops._selectPlan(this.details)},this.unselect=()=>{this._ops._selectPlan(null)},this.placeOrder=(e,t)=>this._ops._placeOrder(this.details,e,t)}}!function(e){e.Order="Order",e.Success="Success"}(s||(s={})),function(e){e[e.Step1=0]="Step1",e[e.Step2=1]="Step2"}(n||(n={})),function(e){e[e.Step1=0]="Step1",e[e.Step2=1]="Step2",e[e.Step3=2]="Step3",e[e.Step4=3]="Step4",e[e.Step5=4]="Step5"}(a||(a={})),function(e){e.selectPlanTier=function(e,t){return(0,c._)((0,l._)({},e),{selectedPlanTier:t,selectedPlans:e.plans.filter((e=>e.details.tier===t)).slice(0,3)})},e.selectPlan=function(e,t){const i=b.getEq(_.c.Plan.eq),s=e=>i.equals(t,b.some(e.details)),n=e=>e.toggleActive(s(e));return(0,c._)((0,l._)({},e),{plans:e.plans.map(n),selectedPlans:e.selectedPlans.map(n),selectedPlan:b.fromNullable(e.plans.find(s))})}}(o||(o={}));class V{clearModals(){(0,m.pipe)(this._orderModalViewModelOption,b.map((e=>e.dispose()))),this._orderModalViewModelOption=b.none}newOrderModalViewModel(){const e=new R(this._closeModal);return this._orderModalViewModelOption=b.some(e),e}closeModal(){this.modal.set(b.none),this.leftStep.set(a.Step1),this.rightStep.set(n.Step1),this.freeProofitTermsAgreed.set(!1)}showOrderModal(){this.modal.set(b.some({type:s.Order}))}selectUserInput(e,t){this.viewState.modify(b.map((i=>(0,c._)((0,l._)({},i),{userInputs:(0,c._)((0,l._)({},i.userInputs),{[e]:t})}))))}dispose(){this.clearModals(),this._subscriptions.dispose()}_showPaymentMessage(){return this._notificationsManager.enqueue("paymentSuccess")}_showPaymentError(){return this._notificationsManager.enqueue("paymentError")}_showSuccessModal(){return this._log.info("Show Success Modal"),this._proofit.jobDetails.pipe(w.oE,E.z(this._user.profile,(({dueTime:e},{email:t})=>b.some({type:s.Success,payload:{email:t,dueDate:e}}))),T.$(),x.M(P.H9(this.modal)))}_createErrorNotification(e,t){switch(e){case"payment":return this._notificationsManager.enqueue("proofitPaymentDeclinedError",{paymentMethod:t}).pipe(M.p((e=>"navigateToSubscription"===e)),x.M((()=>window.open(this._config.account.subscription,"_blank"))));case"emptyDocument":return this._notificationsManager.enqueue("proofitEmptyDocumentError");case"alreadyProofread":return this._notificationsManager.enqueue("proofitDocumentProofreadError").pipe(M.p((e=>"navigateToDocuments"===e)),x.M(this._goToMyDocuments));case"complexInternalStructure":return this._notificationsManager.enqueue("proofitComplexInternalStructureError").pipe(M.p((e=>"navigateToDocuments"===e)),x.M(this._goToMyDocuments));case"unknown":return this._notificationsManager.enqueue("error");default:return(0,p.xb)(e)}}_getUserInputs(){return(0,m.pipe)(this.viewState.get(),b.map((({userInputs:e})=>e)),b.getOrElse((0,m.constant)({nativeLanguage:b.none,dialect:b.none,quotationType:b.none,spaceType:b.none,noteToEditor:b.none})))}_updateUserNativeLanguage(){const e=this._getUserInputs();b.getEq(u.w_).equals(e.nativeLanguage,this._initialNativeLanguage)||(0,m.pipe)(e.nativeLanguage,v.Mi((e=>this._user.updateUserNativeLanguage(e)())))}_getPriceOfferId(){const e=this.viewState.get();return(0,p.V1)(!b.isNone(e),"Proofit view state should be initialized"),v.$v(e).priceOfferId}constructor(e,t,i,u,v,P,W){(0,r._)(this,"_subscription",void 0),(0,r._)(this,"_documentModel",void 0),(0,r._)(this,"_ded",void 0),(0,r._)(this,"_user",void 0),(0,r._)(this,"_notificationsManager",void 0),(0,r._)(this,"_router",void 0),(0,r._)(this,"_config",void 0),(0,r._)(this,"modal",void 0),(0,r._)(this,"isVisibleModal",void 0),(0,r._)(this,"noteToEditor",void 0),(0,r._)(this,"isInternalUser",void 0),(0,r._)(this,"freeProofitTermsAgreed",void 0),(0,r._)(this,"requirePaymentCheck",void 0),(0,r._)(this,"viewState",void 0),(0,r._)(this,"subscriptionState",void 0),(0,r._)(this,"braintreeApi",void 0),(0,r._)(this,"leftStep",void 0),(0,r._)(this,"rightStep",void 0),(0,r._)(this,"_orderModalViewModelOption",void 0),(0,r._)(this,"_initialNativeLanguage",void 0),(0,r._)(this,"viewStateAndSubscription",void 0),(0,r._)(this,"_proofit",void 0),(0,r._)(this,"_subscriptions",void 0),(0,r._)(this,"_closeModal",void 0),(0,r._)(this,"changeLeftStep",void 0),(0,r._)(this,"changeRightStep",void 0),(0,r._)(this,"placeOrderAfterAntiFraudCheck",void 0),(0,r._)(this,"onBillingError",void 0),(0,r._)(this,"requestPlans",void 0),(0,r._)(this,"requestStatistics",void 0),(0,r._)(this,"selectPlanTier",void 0),(0,r._)(this,"_selectPlan",void 0),(0,r._)(this,"_placeOrder",void 0),(0,r._)(this,"_onBillingSuccess",void 0),(0,r._)(this,"_log",void 0),(0,r._)(this,"_goToMyDocuments",void 0),this._subscription=e,this._documentModel=t,this._ded=i,this._user=u,this._notificationsManager=v,this._router=P,this._config=W,this.modal=h.s.create(b.none),this.isVisibleModal=this.modal.lens(g.vt(b.isSome,((e,t)=>e?t:b.none))),this.viewState=h.s.create(b.none),this.subscriptionState=this._subscription.state,this.braintreeApi=this._subscription.braintreeApi,this.leftStep=h.s.create(a.Step1),this.rightStep=h.s.create(n.Step1),this._orderModalViewModelOption=b.none,this._initialNativeLanguage=b.none,this.viewStateAndSubscription=this.viewState.pipe(E.z(this._subscription.state)),this._subscriptions=new C.y.Keeper,this._closeModal=()=>this.modal.set(b.none),this.changeLeftStep=e=>{this.leftStep.set(e)},this.changeRightStep=e=>{this.rightStep.set(e)},this.placeOrderAfterAntiFraudCheck=e=>{this._log.info("Anti-fraud place order after check"),this._subscriptions.push(this.viewStateAndSubscription.pipe(T.$(),k.T((([e])=>e)),k.T(b.chain((e=>e.selectedPlan))),I.n(b.fold(Promise.resolve,(t=>t.placeOrder(b.some(e),!1))))).subscribe((()=>this._onBillingSuccess()),(()=>this.onBillingError())))},this.onBillingError=()=>{this._subscriptions.push(this._showPaymentError().subscribe())},this.requestPlans=this._ded.contentUpdated.pipe(M.p(S.D_.isTextMaybeWithFormatting),O.Z(1e3),B.Z(void 0),I.n((()=>Promise.all([this._proofit.getPlans(),this._user.getUserNativeLanguage()]))),K.l(H.j.OperationRetrier.RetryStrategy.conditional((e=>"TimeoutError"===e.name||"NotConnectedError"===e.name),H.j.OperationRetrier.RetryStrategy.linear(2,1e3))),x.M((([e,t])=>{this._initialNativeLanguage=(0,m.pipe)(t,d.getOrElse((()=>b.none)));const i=[...e.turnaroundOptions,...e.clarityTurnaroundOptions].map((e=>new U(e,this))),s={words:e.words,selectedPlanTier:_.c.PlanTier.Base,plans:i,selectedPlans:[],selectedPlan:b.none,proofitState:b.none,statistics:b.none,userInputs:(0,m.pipe)(t,d.fold((()=>e.userInputs),(t=>(0,c._)((0,l._)({},e.userInputs),{nativeLanguage:t,noteToEditor:b.none})))),priceOfferId:e.priceOfferId},n=(e,t)=>e.some((({details:e})=>e.tier===t&&(0,m.pipe)(e.credits,b.fold((()=>!1),(e=>e.canBeUsed&&e.balance>0))))),a=n(i,_.c.PlanTier.Base),r=n(i,_.c.PlanTier.Clarity),u=a&&!r?_.c.PlanTier.Base:_.c.PlanTier.Clarity;this.viewState.set(b.some(o.selectPlanTier(s,u)))})),N.W((e=>(this._log.error("Error querying proofit plan options",e),this._notificationsManager.enqueue("error").pipe(M.p(y.H.isCloseAction),x.M((()=>this.modal.set(b.none))))))),D.j((()=>{this.viewState.set(b.none)})),A.u()),this.requestStatistics=()=>this._proofit.getStatistics().pipe(K.l(H.j.OperationRetrier.RetryStrategy.conditional((e=>"NotConnectedError"===e.name),H.j.OperationRetrier.RetryStrategy.linear(2,1e3))),x.M((e=>{this.viewState.modify(b.map((t=>(0,c._)((0,l._)({},t),{statistics:e}))))})),N.W((e=>(this._log.debug("Error querying proofit statistics",e),L.of(b.none))))),this.selectPlanTier=e=>{this.viewState.modify(b.map((t=>o.selectPlan(o.selectPlanTier(t,e),b.none))))},this._selectPlan=e=>{this.viewState.modify(b.map((t=>o.selectPlan(t,b.fromNullable(e)))))},this._placeOrder=(e,t,i)=>(this._updateUserNativeLanguage(),this._proofit.placeOrder(e,this._getUserInputs(),this._getPriceOfferId(),t,i)),this._onBillingSuccess=()=>{this._subscriptions.push(this._showPaymentMessage().subscribe())},this._log=f.Bx.Logging.getLogger("ProofitView"),this._goToMyDocuments=()=>{this._router.navigateAndReload(q.Lz.routes.documents.href(),{proofitSubmitted:!0})},this._proofit=this._documentModel.proofit,this.isInternalUser=this._user.features.denali.isInternalUser,this.noteToEditor=this._user.features.denali.proofitNoteToEditor,this.requirePaymentCheck=this._user.features.denali.requirePaymentCheck?h.s.create(!0):this.viewState.view((0,m.flow)(b.chain((e=>e.selectedPlan)),b.map((e=>e.details.requirePaymentCheck)),b.getOrElse(m.constFalse))),this.freeProofitTermsAgreed=h.s.create(!1),this._subscriptions.push(this._proofit.state.pipe(x.M((e=>this.viewState.modify(b.map((t=>(0,c._)((0,l._)({},t),{proofitState:e})))))),w.oE,I.n((e=>{switch(e.kind){case"submitted":return this._log.info("Document submitted for proofreading"),this._showSuccessModal();case"finished":case"cancelled":case"sending":return F.w;case"error":return this._log.error("Error sending document for proofreading:",e.errorType),this._createErrorNotification(e.errorType,this._subscription.state.get().value.paymentMethod);default:return(0,p.xb)(e)}}))).subscribe()),this._subscriptions.push(this.modal.pipe($.J(),M.p((([e])=>(0,m.pipe)(e,b.exists((e=>e.type===s.Success)))))).subscribe(this._goToMyDocuments))}}},72204:(e,t,i)=>{i.d(t,{jH:()=>H,zL:()=>N});var s,n=i(23988),a=i(66202),o=i(65390),r=i(84647),l=i(84712),c=i(90829),d=i(1224),u=i(51770),m=i(63967),p=i(62597),h=i(22809),g=i(53717),_=i(10479),f=i(99010),b=i(47456),v=i(3016),S=i(84872),y=i(4444),w=i(7149),E=i(32102),T=i(91745),x=i(79937),P=i(27156),M=i(52418),C=i(60553),k=i(75248),I=i(25093),O=i(57836),B=i(48779),K=i(78674);function H(e){return t=>({id:t.id,categoryHuman:t.toLiteAlert().categoryHuman,lensId:t.lensId,getHighlightRanges:t.getHighlightRanges,content:(0,r.pipe)(t.transform,o.filter((()=>!(m.Fc.isSuperAlert(t)||m.Fc.isOneGap(t)||m.bU.isSimple(t.extraProperties.cardType)||m.bU.isFullSentence(t.extraProperties.cardType)))),o.chain((0,r.flow)(e,a.fold((e=>(d.Bx.Logging.getLogger("ReportViewModel.hydration").error("Could not hydrate alert",e.error),o.none)),o.some))),a.fromOption((()=>t.highlightTexts)))})}class N{_prepareDownload(){return this._engine.sessionModel.extraSettings.checkedPlagiarism&&!this._features.isFree.get()?this._engine.plagiarismModel.recheck():Promise.resolve()}tryToInterrupt(){this._requestSent.get()||this._finishDownload()}_calculateIssues(e){return e.reduce(((e,t)=>{const i=p.J.OutcomeId.fromOutcomeId(t.lensId),s=t.toLiteAlert(),n=s.categoryHuman;return e[i]=Boolean(e[i])?e[i]:{},e[i][n]=e[i][n]||0,e[i][n]+=s.cost,e}),{})}generateReport(e,t,i){this._requestSent.get()||(this._requestSent.set(!0),this._subs.push(_.H(this._engine.sessionModel.generateReport(e,{headerTemplate:t,footerTemplate:i,format:"Letter",marginTop:"70px",marginBottom:"70px"})).pipe(f.M(this._finishDownload),b.W((e=>(this._log.error("generateReport failed",e),this._notificationsManager.enqueue("error"))))).subscribe()))}_getNonPremiumSortedAlerts(e){return e.map(this._alertDataProcessor)}_getFilteredAlerts(e){return(0,r.pipe)(this._engine.checkingDomain.state.get(),h.A.reduce([],((t,i)=>(e(i.alert)&&t.push(i.alert),t))))}dispose(){this._subs.dispose()}constructor(e,t,i,s,a,h,N,D,A,L){(0,n._)(this,"_engine",void 0),(0,n._)(this,"_profile",void 0),(0,n._)(this,"_features",void 0),(0,n._)(this,"_notificationsManager",void 0),(0,n._)(this,"_htmlContent",void 0),(0,n._)(this,"_telemetry",void 0),(0,n._)(this,"reportData",void 0),(0,n._)(this,"downloadStarted",void 0),(0,n._)(this,"_log",void 0),(0,n._)(this,"_subs",void 0),(0,n._)(this,"_requestSent",void 0),(0,n._)(this,"_visitLenses",void 0),(0,n._)(this,"beginDownload",void 0),(0,n._)(this,"_finishDownload",void 0),(0,n._)(this,"_getReportModel",void 0),(0,n._)(this,"_alertDataProcessor",void 0),(0,n._)(this,"_listenDownload",void 0),this._engine=e,this._profile=t,this._features=i,this._notificationsManager=s,this._htmlContent=a,this._telemetry=L,this.reportData=l.s.create(o.none),this.downloadStarted=l.s.create(!1),this._log=d.Bx.Logging.getLogger("ReportViewModelImpl"),this._subs=new v.y.Keeper,this._requestSent=l.s.create(!1),this._visitLenses=e=>{e.activeLensId.get()!==p.J.SpecialId.Plagiarism&&this._engine.sessionModel.extraSettings.checkedPlagiarism&&e.events.next({type:"switchToLens",id:p.J.SpecialId.Plagiarism,focusFirst:!1,actionSource:m.Kz.sidebar}),e.events.next({type:"switchToLens",id:p.J.SpecialId.AllAlerts,focusFirst:!1,actionSource:m.Kz.sidebar})},this.beginDownload=()=>{this._telemetry.gnarSpec.detailedReportDownloadButtonClick(this._telemetry.pageId,(0,r.pipe)(this._engine.sessionModel.score.get(),o.map((0,u.Up)("rank")),o.getOrElse((0,r.constant)(0)))),this.downloadStarted.set(!0)},this._finishDownload=()=>{this.downloadStarted.set(!1),this._requestSent.set(!1),this.reportData.set(o.none)},this._getReportModel=e=>S.z(this._engine.sessionModel.title.view((e=>Boolean(e)?e:"Untitled")),this._engine.sessionModel.recentDocumentStats.pipe(y.oE),this._engine.sessionModel.score.pipe(y.oE),this._engine.sessionModel.counters,S.z(this._features.isPremium,e).pipe(w.T((([e,t])=>e?(0,r.pipe)(t,o.map((e=>({score:E.Q.groupSum.concat(E.Q.MAX,E.Q.groupSum.inverse(E.Q.fromRatio(e.percentile))),sources:e.count,state:K.p.PlagiarismCheckingState.CHECKED,sortedAlerts:this._getFilteredAlerts(m.Fc.isPlagiarism)}))),o.alt((()=>o.some({state:K.p.PlagiarismCheckingState.NOT_CHECKED})))):o.none))),this._htmlContent).pipe(w.T((([e,t,i,s,n,a])=>{const r=this._getFilteredAlerts((0,c.M4)((0,c.M4)(m.Fc.isApplicableAlert,(0,c.AU)(m.Fc.isMuted)),m.Fc.isRegistered));return o.some({sortedAlerts:this._getNonPremiumSortedAlerts(r),dedHTML:a,title:e,author:this._profile.get().fullName,stats:t,score:i.rank,criticalIssues:s.critical,advancedIssues:s.advanced,issues:this._calculateIssues(r),plagiarism:n})}))),this._listenDownload=(e,t,i)=>{this._subs.push(this.downloadStarted.pipe(T.p(Boolean),x.n((()=>_.H(this._prepareDownload()).pipe(P.w(24e3),f.M((()=>this._visitLenses(t()))),M.Q(C.$),x.n((()=>e().flush())),k.K(this._getReportModel(i).pipe(I.$())),b.W((e=>(this._log.error("Error while preparing PDF report",e),this._finishDownload(),this._notificationsManager.enqueue("error").pipe(O.u(o.none))))))))).subscribe(B.H9(this.reportData)))},this._alertDataProcessor=H(h),this._listenDownload(N,D,A.view(g.x.lookup(p.J.SpecialId.Plagiarism)))}}!function(e){e.Mock=class{constructor(){(0,n._)(this,"downloadStarted",l.s.create(!1)),(0,n._)(this,"beginDownload",r.constVoid),(0,n._)(this,"tryToInterrupt",r.constVoid),(0,n._)(this,"generateReport",(()=>{throw new Error("Method not implemented.")})),(0,n._)(this,"reportData",l.s.create(o.none)),(0,n._)(this,"dedHTML",""),(0,n._)(this,"dispose",r.constVoid),(0,n._)(this,"sortedAlerts",void 0),(0,n._)(this,"sortedPlagiarismAlerts",void 0)}}}(s||(s={}))},33373:(e,t,i)=>{i.d(t,{M:()=>g,U:()=>s});var s,n=i(23988),a=i(65390),o=i(84647),r=i(75336),l=i(9079),c=i(7149),d=i(5692),u=i(30343),m=i(5406),p=i(39812),h=i(98719);class g{isUploaded(e,t){const i=(0,o.pipe)(this._appRouter.locationState,a.chain((e=>a.fromNullable(e.uploadedFileType)))),s=(0,o.pipe)(this._appRouter.locationState,a.chain((e=>a.fromNullable(e.uploadedFileName)))),n=void 0!==e?(0,o.pipe)(i,a.exists((t=>t===e))):a.isSome(i),r=void 0!==t?(0,o.pipe)(s,a.exists((e=>t.test(e)))):a.isSome(s);return n||r}dispose(){this.uploadModel.dispose()}constructor(e,t,i,s,a,o){(0,n._)(this,"_doxApi",void 0),(0,n._)(this,"_appRouter",void 0),(0,n._)(this,"_notificationsManager",void 0),(0,n._)(this,"_telemetry",void 0),(0,n._)(this,"_environment",void 0),(0,n._)(this,"_config",void 0),(0,n._)(this,"_upload",void 0),(0,n._)(this,"_navigateToDocument",void 0),(0,n._)(this,"uploadModel",void 0),(0,n._)(this,"state",void 0),this._doxApi=e,this._appRouter=t,this._notificationsManager=i,this._telemetry=s,this._environment=a,this._config=o,this._upload=e=>this._doxApi.createDocument(r.J.Create.file(e,r.J.UploadFileMode.plain)),this._navigateToDocument=(e,t)=>this._appRouter.navigate(p.Lz.routes.denali_editor.href({docId:e}),t),this.uploadModel=new h.DJ.fQ((e=>this._upload(e)),this._navigateToDocument.bind(this),this._telemetry,this._notificationsManager,this._environment,this._config),this.state=this.uploadModel.state.pipe(l.J(),c.T((([e,t])=>d.j.isInProgress(t)?d.j.Status.inProgress:d.j.isOk(t)||d.j.isIdle(t)&&d.j.isOk(e)?d.j.Status.ok:d.j.Status.idle)),u.Z(d.j.Status.idle))}}!function(e){e.Mock=class{isUploaded(e,t){throw new Error("Method not implemented.")}showUploadNotificationIfNeeded(){throw new Error("Method not implemented.")}constructor(){(0,n._)(this,"uploadModel",{navigated:o.constVoid}),(0,n._)(this,"state",m.w),(0,n._)(this,"dispose",o.constVoid)}}}(s||(s={}))},39355:(e,t,i)=>{i.d(t,{p:()=>_});var s=i(85886),n=i(71301),a=i(82608),o=i(86922),r=i(19967),l=i(14973),c=i(11864),d=i(27199);const u={margin:`${c.Ks.rem(.8)} 0`},m={display:"inline-block",marginBottom:c.Ks.rem(.2),color:d.Q1.CoreBlue50,textTransform:"lowercase"},p={color:d.Q1.CoreNeutral90,textTransform:"uppercase",fontSize:c.Ks.rem(.8)},h={marginTop:c.Ks.rem(1.4),marginBottom:c.Ks.rem(1)},g=c.Ks.stylesheet({timeWrapper:[u],time:[m],date:[p],description:[h]}),_=({payload:e,close:t})=>{const i=s.useContext(o.S.Context),c=s.useContext(l.aF.TitleIdContext);return s.createElement("div",null,s.createElement(a.Typography,{nodeType:"h2",styleType:a.Typography.Type.H3,id:c},i.proofitSuccessModal.title),s.createElement("div",{className:g.timeWrapper},s.createElement(a.Typography,{nodeType:"h3",styleType:a.Typography.Type.H2,className:g.time,"data-name":"success-time"},n.Yr.shortTime(e.dueDate)),s.createElement("div",{className:g.date,"data-name":"success-date"},n.Yr.fullDate(e.dueDate))),s.createElement(a.Typography.Base,{className:g.description},i.proofitSuccessModal.description(e.email)),s.createElement(r.$n.Primary,{name:"got-it",onClick:t},i.actions.gotIt))}},24119:(e,t,i)=>{i.d(t,{E:()=>It});var s=i(10334),n=i(17171),a=i(85886),o=i(66202),r=i(84647),l=i(59893),c=i(13490),d=i(58691),u=i(77205),m=i(98274),p=i(56062),h=i(17413),g=i(14934),_=i(686),f=i(87042),b=i(65987),v=i(30634),S=i(49264),y=i(49961),w=i(13818),E=i(79471),T=i(77744),x=i(70225),P=i(35314),M=i(15003),C=i(75993),k=i(80529),I=i(75784),O=i(35378),B=i(66976),K=i(45012),H=i(79745),N=i(83407),D=i(24819),A=i(56855),L=i(80843),F=i(65390),$=i(65160),q=i(51770),W=i(21607),R=i(76005),U=i(86922),V=i(19967),j=i(14737),J=i(88502),z=i(19772),Q=i(91745),G=i(93432),Y=i(75248),X=i(4444),Z=i(33011),ee=i(99010),te=i(79937),ie=i(99339),se=i(7149),ne=i(93208),ae=i(79),oe=i(34553),re=i(60352),le=i(30343),ce=i(11089),de=i(89011),ue=i(82315),me=i(20408),pe=i(60172),he=i(93712),ge=i(19436),_e=i(11871),fe=i(5731),be=i(79239),ve=i(26816),Se=i(37634),ye=i(98205),we=i(88480),Ee=i(21037),Te=i(11864),xe=i(13607),Pe=i(57014);const Me=19.5,Ce=Te.Ks.milliseconds(500),ke={display:"flex",width:Te.Ks.percent(100),height:Te.Ks.percent(100),alignItems:"center"},Ie={position:Te.Ks.important("fixed"),left:Te.Ks.important(Te.Ks.rem(18.5)),minWidth:Te.Ks.important("auto")},Oe={color:Se.Q.Text.Base.Subdued,margin:`0 ${Te.Ks.rem(1.7)} 0 auto`,fontSize:Te.Ks.rem(ye.CN)},Be=Te.Ks.prefixedStylesheet("dropdown",{button:[ke],item:[{whiteSpace:"nowrap",textTransform:"capitalize"}],popover:[Ie],arrow:[Oe]}),Ke="@media (max-width: 1080px)",He={position:"absolute",transform:`translate(${Te.Ks.rem(-.25)}, ${Te.Ks.rem(-.25)})`,$nest:{[Ke]:{transform:`translate(${Te.Ks.rem(ye.v5)}, ${Te.Ks.rem(-2.5)})`}}},Ne={position:"absolute",top:0,left:"-20.5rem",width:Te.Ks.rem(Me),height:"var(--100vh)",backgroundColor:Se.Q.Background.Base.Default,boxShadow:we.$t.boxShadow,transition:`transform ${Ce}`,pointerEvents:"none",alignItems:"start"},De={zIndex:xe.yg,transform:`translateX(${Te.Ks.rem(20.5)})`,pointerEvents:"all"},Ae={position:"absolute",top:Te.Ks.rem(ye.Jj),left:Te.Ks.rem(.7),display:"flex",flexDirection:"column",width:Te.Ks.rem(6),height:"var(--100vh)",transition:`opacity ${Ce}`,pointerEvents:"none"},Le={position:"relative",minHeight:Te.Ks.rem(ye.Oh),borderRadius:Te.Ks.rem(ye.Jj),boxShadow:we.R$.boxShadow,transitionTimingFunction:"cubic-bezier(.42, 0, .58, 1)",pointerEvents:"all"},Fe={zIndex:xe.yg,width:Te.Ks.rem(4.2),transition:"transform .2s, box-shadow .2s, width .3s",borderRadius:`${Te.Ks.rem(ye.Jj)} ${Te.Ks.rem(ye.Jj)} ${Te.Ks.rem(ye.Jj)} 0`},$e={zIndex:xe.do,width:Te.Ks.rem(Me),transition:"transform .2s, box-shadow .2s, width .7s"},qe={$nest:{[Ke]:{display:Te.Ks.important("none")}}},We={$nest:{[Ke]:{width:Te.Ks.rem(3)}}},Re={position:"fixed",top:0,left:0,zIndex:xe.yg,marginTop:Te.Ks.rem(ye.Jj),width:Te.Ks.rem(Me),height:Te.Ks.rem(ye.Oh)},Ue={zIndex:xe.do,pointerEvents:"all"},Ve={marginBottom:Te.Ks.rem(ye.v5)},je={borderRadius:Te.Ks.rem(Ee.KD),color:Se.Q.Text.Base.Subdued,pointerEvents:"all"},Je={width:Te.Ks.rem(ye.Oh),height:Te.Ks.rem(ye.Oh)},ze={marginLeft:Te.Ks.rem(ye.v$),$nest:{[Ke]:{marginLeft:0}}},Qe={position:"absolute",top:0,left:0,zIndex:xe.do},Ge={$nest:{[`${Pe.$U.tiny}, ${Pe.$U.normalLower}, ${Pe.$U.bigHigher}`]:{display:Te.Ks.important("none")}}},Ye={$nest:{[`${Pe.$U.tiny}, ${Pe.$U.normalLower}, ${Pe.$U.bigHigher}`]:{width:Te.Ks.rem(3),$nest:{"& > div":{justifyContent:"center"}}}}},Xe={width:Te.Ks.rem(3)},Ze={display:"flex",marginBottom:Te.Ks.rem(ye.v5),minHeight:Te.Ks.rem(ye.Oh),justifyContent:"space-between",alignItems:"center",gap:Te.Ks.rem(ye.or),padding:`0 ${Te.Ks.rem(ye.or)}`,$nest:{[Ke]:{justifyContent:"center"}}},et={transition:"transform .1s",$nest:{"&:hover":{borderRadius:Te.Ks.rem(Ee.Dk),cursor:"pointer",transform:"scale(1.075)"}}},tt={width:Te.Ks.important("auto"),height:Te.Ks.important("auto"),padding:Te.Ks.important(Te.Ks.rem(ye.or)),$nest:{"&:hover":{backgroundColor:Te.Ks.important("transparent")}}},it={$nest:{[Pe.$U.big]:{paddingLeft:Te.Ks.important(Te.Ks.rem(.35))}}},st={zIndex:2,margin:`${Te.Ks.rem(ye.or)} ${Te.Ks.rem(1.2)}`,minHeight:1,width:`calc(100% - ${Te.Ks.rem(ye.Oh)})`,backgroundColor:Se.Q.Border.Base.Subdued},nt={minHeight:Te.Ks.rem(ye.Oh),width:Te.Ks.percent(100)},at={marginRight:Te.Ks.rem(ye.Jj)},ot={paddingLeft:Te.Ks.rem(3.5)},rt={overflow:"hidden",margin:Te.Ks.important(`0 ${Te.Ks.rem(1.7)} 0 auto`),color:Se.Q.Text.Base.Subdued,textOverflow:"ellipsis",whiteSpace:"nowrap"},lt={margin:`0 ${Te.Ks.rem(ye.CN)}`,display:"flex",alignItems:"center",justifyContent:"center",minWidth:Te.Ks.rem(ye.Oh)},ct={display:"flex",overflow:"hidden",paddingLeft:Te.Ks.rem(3.5),minHeight:Te.Ks.rem(2.3),width:Te.Ks.percent(100),alignItems:"center"},dt={color:Se.Q.Text.Base.Subdued,letterSpacing:Te.Ks.px(.3)},ut=(0,n._)((0,s._)({},ct),{minHeight:Te.Ks.rem(1.45),alignItems:"flex-end"}),mt={color:Se.Q.Text.Base.Default,fontWeight:"bold",fontSize:Te.Ks.important(Te.Ks.rem(ye.Jj))},pt=(0,n._)((0,s._)({},ct),{minHeight:Te.Ks.rem(ye.v5),alignItems:"flex-start"}),ht={color:Se.Q.Text.Base.Subdued},gt={position:"sticky",top:0,zIndex:1,width:Te.Ks.rem(19),height:Te.Ks.rem(3.6),boxShadow:"0 0 10px 10px rgba(255, 255, 255, 0.78)"},_t=(0,n._)((0,s._)({},ke),{color:Se.Q.Text.Base.Subdued}),ft=(0,n._)((0,s._)({},_t),{transition:"background-color 0.7s"}),bt=(0,n._)((0,s._)({},_t),{backgroundColor:Te.Ks.important("transparent")}),vt=(0,n._)((0,s._)({},at),{opacity:1,transition:"opacity 0.7s"}),St=(0,n._)((0,s._)({},at),{opacity:0,transition:"opacity 0.3s"}),yt=(0,n._)((0,s._)({},nt),{margin:`${Te.Ks.rem(ye.or)} 0`}),wt={marginLeft:Te.Ks.rem(ye.CN)},Et={width:Te.Ks.rem(ye.Jj),transition:"transform 0.4s linear",transform:"scale(0)"},Tt={verticalAlign:"middle",transition:"transform 0.4s linear",transform:"scale(0.8)",minWidth:Te.Ks.rem(1.6),minHeight:Te.Ks.rem(ye.Oh)},xt={top:Te.Ks.rem(ye.Jj)},Pt=Te.Ks.prefixedStylesheet("document-settings",{greenDot:[He],toolbarAdditionalActions:[{marginTop:"auto"}],toolbarSupportButton:[Ve,je,Je,ze],toolbarCollapsed:[Ae,{opacity:0}],toolbarExpanded:[Ae,{opacity:1}],documentSettings:[Ne],documentSettingsExpanded:[Ne,De],closeButtonWrapperCollapsed:[Re,{pointerEvents:"none"}],closeButtonWrapperExpanded:[Re,Ue],expandButtonAnimationWrapperCollapsed:[Le,$e],expandButtonAnimationWrapperExpanded:[Le,Fe],expandButtonHiddenWhenXSmall:[qe],expandButtonSquashedWhenXSmall:[We],leftSidebar:[Qe],scrollableContent:[{position:"relative",display:"flex",flexDirection:"column",height:"calc(100% - 4rem)"}],expandButtonContainer:[{position:"absolute"}],expandButtonHiddenWhenSmall:[Ge],expandButtonSquashedWhenSmall:[Ye],expandButtonSquashed:[Xe],expandButton:[Ze],expandIconButton:[et,tt],backToHomeButton:[et,tt,it],separator:[st],menuButtonWrapper:[nt],menuButton:[ke],menuTitle:[at],menuText:[ot],label:[rt],icon:[lt],header:[ct],headerText:[dt],userNameHeader:[ut],userName:[mt],emailHeader:[pt],email:[ht],menuHead:[gt],closeButton:[_t],closeButtonExpanded:[ft],closeButtonCollapsed:[bt],closeButtonTitleExpanded:[vt],closeButtonTitleCollapsed:[St],oneItemContainer:[yt],accountHeaderLabel:[wt],iconCollapsed:[Et],iconExpanded:[Tt],onboardingSpot:[xt]});var Mt=i(18810);function Ct(e){switch(e){case"chrome":case"firefox":case"edge":case"safari":return e;default:return"other"}}function kt(e){switch(e){case"windows":case"mac":case"linux":case"android":case"ios":return e;default:return"other"}}const It=({documentSettingsViewModel:e,isSidebarOpen:t,isDemoMode:i,showOnboardingTourA11yUpdates:s})=>{const{landmark:n}=a.useContext(U.S.Context);return a.createElement("aside",{className:Pt.leftSidebar,"aria-label":n.documentMenu},a.createElement(Ot,{viewModel:e}),a.createElement(Ht,{documentSettingsViewModel:e,isSidebarOpen:t,isDemoMode:i,showOnboardingTourA11yUpdates:s}))},Ot=({viewModel:e})=>{const{ref:t,onMount:i}=z.R.useElWatcher(),s=a.useContext(U.S.Context);z.R.FocusTrap.useFocusTrap(e.visualState.pipe(Q.p(Ut.isExpanded),G.c(500),Y.K(t)));const n=t.pipe(X.oE),o=new Z.t(0),l=e.visualState.pipe(Q.p(Ut.isExpanded),ee.M((()=>o.next(0)))),c=e.visualState.pipe(Q.p(Ut.isExpanded),te.n((()=>ie.R(document,"mousedown").pipe(se.T((e=>F.fromNullable(e.target)))))),ne.E(n),Q.p((([e,t])=>!(0,r.pipe)(e,F.exists((e=>(0,N.pu)(t,e)))))),ee.M((()=>e.visualState.set({type:be.VV.Collapsed}))));z.R.useSubscriptionTo(l.pipe(ae.h(c))),z.R.useSubscriptionTo((0,r.pipe)(n,te.n((t=>e.visualState.view(Ut.isExpanded).pipe(ee.M((e=>e?t.removeAttribute("inert"):t.setAttribute("inert","true"))))))));const d=new oe.B;return a.createElement(A.F.Fragment,null,e.visualState.view((t=>{const n=Ut.isExpanded(t);return a.createElement("nav",{"aria-label":s.documentSettings.label,className:n?Pt.documentSettingsExpanded:Pt.documentSettings,ref:i,onMouseEnter:e.onMenuHovered},a.createElement(Dt,{viewModel:e}),a.createElement("div",{className:Pt.menuHead}),a.createElement(J.G,{name:"documentSettingsScroll",showWhenScrollable:!0,className:Pt.scrollableContent,scrollTo:o,key:t.type,onScroll:d},e.items.map(((e,i)=>ve.W.Item.isViewItem(e)?Ut.isHeader(e.name)?a.createElement(Nt,{item:e,key:i}):a.createElement(A.F.Fragment,{key:i},e.hidden.view((s=>s?null:a.createElement("div",{ref:i=>{t.type===be.VV.Expanded&&null!==i&&(0,r.pipe)(t.scrollTo,F.filter((t=>t.item===e.name)),$.Mi((e=>o.next(i.getBoundingClientRect().bottom-e.positionY))))},className:Ut.getItemClassName(e.name),key:i},a.createElement(At,{item:e,onScroll:d.pipe(se.T(r.constVoid))}))))):a.createElement(Wt,{key:i})))))})))},Bt=a.memo(fe.B.createComponent({component:A.F.div,section:fe.B.create(fe.B.Id.menu),focusStrategy:ce.a.FocusStrategy.focusRootOrLastFocusable}),r.constTrue),Kt=a.memo(fe.B.createComponent({component:A.F.nav,section:fe.B.create(fe.B.Id.additionalActions)}),r.constTrue),Ht=({documentSettingsViewModel:e,isDemoMode:t,showOnboardingTourA11yUpdates:i})=>{const o=a.useContext(U.S.Context);return a.createElement(A.F.Fragment,null,e.visualState.view((p=>{const h=Ut.isExpanded(p);return a.createElement("nav",{"aria-label":o.documentSettings.toolbarLabel,className:h?Pt.toolbarCollapsed:Pt.toolbarExpanded,key:"documentSettings-toolbar"},a.createElement("div",{className:Pt.expandButtonContainer},a.createElement(A.F.div,(0,s._)({"data-name":"documentSettings-toolbarExpand"},(0,L.Ly)(h?Pt.expandButtonAnimationWrapperCollapsed:Pt.expandButtonAnimationWrapperExpanded,t?Pt.expandButtonSquashed:Pt.expandButtonSquashedWhenXSmall)),a.createElement(Bt,{className:Pt.expandButton},t?null:a.createElement(ge.ie,(0,n._)((0,s._)({"data-name":"documentSettings-toolbarExpand-backToMyGrammarlyInline",accessibilityLabel:"Grammarly Home"},(0,L.Ly)(Pt.backToHomeButton,Pt.expandButtonHiddenWhenXSmall)),{onClick:e.onGoBackToGrammarlyHome,icon:l.c,variant:"tertiary",size:"large"})),a.createElement(ue.M7,{alignment:"bottom",eventType:"onclick",stepId:de.E.StepId.Step10,title:i?o.documentSettings.detailedOnboarding.title:void 0,message:i?o.documentSettings.detailedOnboarding.message:o.documentSettings.onboarding.message,themes:{spotClassName:Pt.onboardingSpot}},a.createElement(c.K,{"data-name":"documentSettings-toolbarExpand-openToolbar",title:"Menu",accessibilityLabel:"Menu",className:Pt.expandIconButton,onClick:e.onOpenToolbar,icon:d.F,variant:"tertiary",size:"large"}))))),a.createElement("div",{className:Pt.toolbarAdditionalActions},a.createElement(Kt,{"aria-label":o.documentSettings.additionalActions},a.createElement(V.$n,{name:"documentSettings-toolbarSupport",className:Pt.toolbarSupportButton,title:o.documentSettings.supportTitle,"aria-label":o.documentSettings.supportTitle,onClick:t=>{e.visualState.set({type:be.VV.Expanded,scrollTo:(0,r.pipe)(Ut.getClickEventY(t),F.map((e=>({item:be.m1.support,positionY:e}))))})}},a.createElement(u.I,{icon:m.V,accessibilityLabel:""})))))})))},Nt=({item:e})=>a.createElement("div",{className:Ut.getItemClassName(e.name)},a.createElement(p.E,{as:"small",variant:"text-xsmall",className:(0,r.pipe)(Ut.getTextClassName(e.name),F.toUndefined)},a.createElement(A.F.Fragment,null,e.title)),a.createElement(qt,{item:e})),Dt=({viewModel:e})=>{const t=Ut.isExpanded(e.visualState.get());return a.createElement("div",{className:t?Pt.closeButtonWrapperExpanded:Pt.closeButtonWrapperCollapsed},a.createElement(V.$n.Flat,{name:`documentSettings-${e.head.name}`,active:e.head.active,disabled:e.head.disabled,animationMode:j.g.None,onClick:e.head.onClick,className:t?Pt.closeButtonExpanded:Pt.closeButtonCollapsed},a.createElement("div",{className:Pt.icon},a.createElement(u.I,{icon:h.A,accessibilityLabel:"",className:t?Pt.iconExpanded:Pt.iconCollapsed})),a.createElement("span",{className:t?Pt.closeButtonTitleExpanded:Pt.closeButtonTitleCollapsed},a.createElement(A.F.Fragment,null,e.head.title))))},At=({item:e,onScroll:t})=>{const i=a.useContext(me._.Context),o=a.useContext(he.OH.Context),l=Ut.getLink(e.name,i,o),c=Ut.getUploadModel(e),d=a.useRef(null),u=()=>{e.onClick(),null!==d.current&&d.current.click()},m=a.createElement(a.Fragment,null,(0,r.pipe)(Ut.getIcon(e),F.fold((()=>a.createElement(A.F.span,{id:e.name,className:Pt.menuText},e.title)),(t=>a.createElement(a.Fragment,null,a.createElement(A.F.div,{"aria-hidden":!0,className:Pt.icon},t),a.createElement(A.F.span,{className:Pt.menuTitle},e.title))))),a.createElement(qt,{item:e})),p=(0,r.pipe)(c,F.map((e=>a.createElement(_e.k,{documentUpload:e,multiple:!1,mount:e=>d.current=e,hideTooltip:!0,ariaHidden:!0}))),F.toNullable);return a.createElement(a.Fragment,null,(0,r.pipe)(l,F.map((t=>a.createElement($t,{item:e,link:t,onClick:u},m))),$.NW((0,r.pipe)(e.nestedItem,F.chain(F.fromEither),F.filter(be.LU.is),F.map((e=>a.createElement(Ft,(0,n._)((0,s._)({},Ut.getDropdownProps(e)),{onScroll:t}),m))))),F.getOrElse((()=>a.createElement(Lt,{item:e,onClick:u},m)))),p)},Lt=({item:e,children:t,onClick:i})=>a.createElement(V.$n.Flat,{name:`documentSettings-${e.name}`,active:e.active,disabled:e.disabled,onClick:i,className:Pt.menuButton},t),Ft=({children:e,items:t,selected:i,onAction:o,onOpenChange:r,onScroll:l})=>a.createElement(A.F.Fragment,null,l.pipe(re.S((e=>++e),0),le.Z(0),se.T((l=>a.createElement(W.W.DropdownLifted,{key:l,label:a.createElement(a.Fragment,null,e,a.createElement("span",{className:Be.arrow,"aria-hidden":!0},"â–¶")),selectionMode:"single",placement:"right",theme:Be,button:V.$n.Flat,selectedKeys:i,onAction:o,items:i.view((e=>t.map((t=>(0,n._)((0,s._)({},t),{selected:e.has(t.text)}))))),onOpenChange:r},(e=>a.createElement(W.W.Item,{key:e.text,textValue:e.text},e.icon,a.createElement(W.W.ItemContent,null,`${e.text} English`)))))))),$t=({item:e,link:t,onClick:i,children:s})=>a.createElement(V.$n.Flat,{name:`documentSettings-${e.name}`,active:e.active,disabled:e.disabled,className:Pt.menuButton,onClick:i,href:t,target:"_blank"},s),qt=({item:e})=>(0,r.pipe)(e.nestedItem,F.map(o.fold((e=>a.createElement(p.E,{as:"small",variant:"text-xsmall",className:Pt.label},e)),Ut.renderNestedItem)),F.toNullable),Wt=()=>a.createElement("div",{className:Pt.separator}),Rt={size:"large",variant:"inherit",accessibilityLabel:""};var Ut;!function(e){function t(e){return a.createElement(_.s,{width:"calc(2px * var(--rem))",height:"calc(2px * var(--rem))",align:"center",justify:"center",marginLeft:-2,marginRight:2},i(e))}function i(e){switch(e){case"american":return a.createElement(u.I,(0,s._)({icon:f.$},Rt));case"british":return a.createElement(u.I,(0,s._)({icon:b.e},Rt));case"canadian":return a.createElement(u.I,(0,s._)({icon:v.X},Rt));case"australian":return a.createElement(u.I,(0,s._)({icon:S.B},Rt));case"indian":return a.createElement(u.I,(0,s._)({icon:y.c},Rt));default:return(0,D.xb)(e)}}function n(e){const t=e.getBoundingClientRect();return t.bottom-t.height/2}e.getDropdownProps=e=>function(e){return{items:Object.values(pe.Vi).map((e=>({text:e,icon:t(e)}))),selected:e.dialectSettings.dialectOrDefault.view((e=>new Set([e]))),onAction:e.changeDialect.bind(e),onOpenChange:e.onStateChange.bind(e)}}(e),e.renderNestedItem=e=>{switch(e.type){case be.W7.uploadFile:return a.createElement(p.E,{as:"small",variant:"text-xsmall",className:Pt.label},e.label);case be.W7.accountHeaderLabel:return a.createElement(A.F.Fragment,null,e.brandingSet.view((0,r.flow)(F.map((e=>e.toLowerCase())),F.map((e=>a.createElement(g.a,{size:"xsmall",variant:e,className:Pt.accountHeaderLabel}))),F.toNullable)));case be.W7.whatsNewUpdates:case be.W7.languageSettings:return a.createElement(a.Fragment,null);default:return(0,D.xb)(e)}},e.getLink=function(e,t,i){switch(e){case be.m1.subscription:return F.some(t.account.subscription);case be.m1.support:return F.some(t.support.mainPage);case be.m1.privacyPolicy:return F.some(t.privacyPolicy);case be.m1.termsOfService:return F.some(t.termsOfService);case be.m1.reportABug:return F.some(function(e,t){return new Mt.U(e.api.inProductReportUrl).addParams({clientVersion:t.buildVersion.toString(),platformVersion:t.info.parsedVersion.toString(),application:window.location.origin,browser:Ct(t.info.browser),os:kt(t.info.os),userType:"business",team:"editor"}).toString()}(t,i));case be.m1.versionHistory:return F.some(t.urls.versionHistory);case be.m1.close:case be.m1.myGrammarly:case be.m1.documentHeader:case be.m1.newDocument:case be.m1.uploadFile:case be.m1.download:case be.m1.print:case be.m1.editHeader:case be.m1.editorSettings:case be.m1.accountHeader:case be.m1.userName:case be.m1.email:case be.m1.upgradeToPremium:case be.m1.language:case be.m1.logout:case be.m1.whatsNew:case be.m1.feedback:case R.H2.undo:case R.H2.redo:case R.H2.cut:case R.H2.copy:case R.H2.paste:case R.H2.selectAll:case be.m1.downloadLogs:return F.none;default:return(0,D.xb)(e)}},e.getUploadModel=(0,r.flow)((0,q.Up)("nestedItem"),F.chain(F.fromEither),F.chain((e=>{switch(e.type){case be.W7.uploadFile:return(0,r.pipe)(e.uploadViewModel,F.map((e=>e.uploadModel)));case be.W7.accountHeaderLabel:case be.W7.whatsNewUpdates:case be.W7.languageSettings:return F.none;default:return(0,D.xb)(e)}}))),e.getIcon=function(e){const t=e.name;switch(t){case be.m1.close:return F.some(a.createElement(u.I,(0,s._)({icon:h.A},Rt)));case be.m1.myGrammarly:return F.some(a.createElement(u.I,(0,s._)({icon:w.P},Rt)));case be.m1.newDocument:return F.some(a.createElement(u.I,(0,s._)({icon:E.k},Rt)));case be.m1.uploadFile:return F.some(a.createElement(u.I,(0,s._)({icon:T.p},Rt)));case be.m1.download:return F.some(a.createElement(u.I,(0,s._)({icon:x._},Rt)));case be.m1.print:return F.some(a.createElement(u.I,(0,s._)({icon:P.T},Rt)));case R.H2.undo:return F.some(a.createElement(u.I,(0,s._)({icon:M.Y},Rt)));case R.H2.redo:return F.some(a.createElement(u.I,(0,s._)({icon:C.W},Rt)));case R.H2.cut:return F.some(a.createElement(u.I,(0,s._)({icon:k.O},Rt)));case R.H2.copy:return F.some(a.createElement(u.I,(0,s._)({icon:I.j},Rt)));case R.H2.paste:return F.some(a.createElement(u.I,(0,s._)({icon:O.f},Rt)));case be.m1.editorSettings:return F.some(a.createElement(u.I,(0,s._)({icon:B.B},Rt)));case be.m1.support:return F.some(a.createElement(u.I,(0,s._)({icon:m.V},Rt)));case be.m1.upgradeToPremium:return F.some(a.createElement(u.I,(0,s._)({icon:K.p},Rt)));case be.m1.versionHistory:return F.some(a.createElement(u.I,(0,s._)({icon:H.k},Rt)));case be.m1.documentHeader:case be.m1.editHeader:case be.m1.accountHeader:case be.m1.userName:case be.m1.email:case be.m1.language:return(0,r.pipe)(e.nestedItem,F.chain(F.fromEither),F.filter(be.LU.is),F.map((e=>e.dialectSettings.dialectOrDefault.view(i))));case be.m1.subscription:case be.m1.logout:case be.m1.whatsNew:case be.m1.feedback:case be.m1.privacyPolicy:case be.m1.termsOfService:case be.m1.reportABug:case be.m1.downloadLogs:case R.H2.selectAll:return F.none;default:return(0,D.xb)(t)}},e.getItemClassName=function(e){switch(e){case be.m1.myGrammarly:case be.m1.editorSettings:return Pt.oneItemContainer;case be.m1.documentHeader:case be.m1.editHeader:case be.m1.accountHeader:return Pt.header;case be.m1.userName:return Pt.userNameHeader;case be.m1.email:return Pt.emailHeader;case be.m1.versionHistory:case be.m1.close:case be.m1.newDocument:case be.m1.uploadFile:case be.m1.download:case be.m1.print:case be.m1.upgradeToPremium:case be.m1.language:case be.m1.subscription:case be.m1.logout:case be.m1.support:case be.m1.whatsNew:case be.m1.feedback:case be.m1.privacyPolicy:case be.m1.termsOfService:case be.m1.reportABug:case be.m1.downloadLogs:case R.H2.undo:case R.H2.redo:case R.H2.cut:case R.H2.copy:case R.H2.paste:case R.H2.selectAll:return Pt.menuButtonWrapper;default:return(0,D.xb)(e)}},e.getTextClassName=function(e){switch(e){case be.m1.userName:return F.some(Pt.userName);case be.m1.email:return F.some(Pt.email);case be.m1.documentHeader:case be.m1.editHeader:case be.m1.accountHeader:return F.some(Pt.headerText);case be.m1.close:case be.m1.myGrammarly:case be.m1.newDocument:case be.m1.uploadFile:case be.m1.download:case be.m1.print:case be.m1.editorSettings:case be.m1.upgradeToPremium:case be.m1.language:case be.m1.subscription:case be.m1.logout:case be.m1.support:case be.m1.whatsNew:case be.m1.feedback:case be.m1.privacyPolicy:case be.m1.termsOfService:case be.m1.reportABug:case be.m1.downloadLogs:case be.m1.versionHistory:case R.H2.undo:case R.H2.redo:case R.H2.cut:case R.H2.copy:case R.H2.paste:case R.H2.selectAll:return F.none;default:return(0,D.xb)(e)}},e.isHeader=function(e){switch(e){case be.m1.documentHeader:case be.m1.editHeader:case be.m1.accountHeader:case be.m1.userName:case be.m1.email:return!0;case be.m1.close:case be.m1.myGrammarly:case be.m1.newDocument:case be.m1.uploadFile:case be.m1.download:case be.m1.print:case be.m1.editorSettings:case be.m1.upgradeToPremium:case be.m1.language:case be.m1.subscription:case be.m1.logout:case be.m1.support:case be.m1.whatsNew:case be.m1.feedback:case be.m1.privacyPolicy:case be.m1.termsOfService:case be.m1.reportABug:case be.m1.downloadLogs:case be.m1.versionHistory:case R.H2.undo:case R.H2.redo:case R.H2.cut:case R.H2.copy:case R.H2.paste:case R.H2.selectAll:return!1;default:return(0,D.xb)(e)}},e.getClickEventY=function(e){return(0,r.pipe)(F.fromNullable(void 0!==e&&e.target),F.map(n))},e.getElementCenter=n,e.isExpanded=function(e){return e.type===be.VV.Expanded}}(Ut||(Ut={}))},8624:(e,t,i)=>{i.d(t,{N:()=>C});var s=i(10334),n=i(85886),a=i(66202),o=i(84647),r=i(686),l=i(44706),c=i(35229),d=i(26061),u=i(88205),m=i(63620),p=i(54521),h=i(31998),g=i(62677),_=i(69436),f=i(24819),b=i(80843),v=i(65160),S=i(65390),y=i(76005),w=i(19436),E=i(26816),T=i(37634),x=i(98205),P=i(11864);const M=P.Ks.prefixedStylesheet("formatting-toolbar",{verticalSeparator:[{margin:P.Ks.rem(.375),width:1,height:P.Ks.rem(1),backgroundColor:T.Q.Icon.Base.Subdued}],formattingButton:[{width:P.Ks.important(P.Ks.rem(x.v5)),height:P.Ks.important(P.Ks.rem(x.v5))}],formattingButtonActive:[{color:P.Ks.important(T.Q.Text.Base.Inverse),backgroundColor:P.Ks.important(T.Q.Background.Neutral.Default)}],bold:[{fontWeight:"bold"}],italic:[{fontStyle:"italic"}],underline:[{textDecoration:"underline"}],link:[{color:T.Q.Text.Brand.Default,textDecoration:"underline"}]}),C=({viewModel:e})=>n.createElement(k,{viewModel:e}),k=({viewModel:e})=>n.createElement(w.S1,{key:"formatting-wrapper",direction:"row",align:"center",gap:.5},e.list.map(((e,t)=>E.W.Item.isViewItem(e)?n.createElement(I,{key:t,item:e}):n.createElement("div",{key:t,className:M.verticalSeparator})))),I=({item:e})=>{const t=B(e);return n.createElement(w.ie,(0,s._)({"data-name":`rtfToolbar-${e.name}`,"data-active":e.active,icon:t.icon,accessibilityLabel:v.$v(e.tooltip),tooltipContentProps:{children:t.tooltip},onClick:e.onClick,size:"small",variant:"tertiary"},(0,b.Ly)(M.formattingButton,e.active.view((e=>e?M.formattingButtonActive:void 0)))))},O=(e,t)=>n.createElement(r.s,{direction:"row",gap:2,align:"center",width:"100%"},(0,o.pipe)(e.tooltip,S.fold((()=>n.createElement(n.Fragment,null)),(e=>n.createElement("span",{className:t},e)))),(0,o.pipe)(e.nestedItem,S.fold(o.constNull,a.fold((e=>n.createElement("span",{className:"gds-typography gds-text gds-text-small gds-tooltip-content-annotation"},e)),o.constNull)))),B=e=>{switch(e.name){case y.M_.Type.bold:return{icon:l.t,tooltip:O(e,M.bold)};case y.M_.Type.italic:return{icon:c.O,tooltip:O(e,M.italic)};case y.M_.Type.underline:return{icon:d.m,tooltip:O(e,M.underline)};case y.M_.Type.header1:return{icon:u.b,tooltip:O(e,"gds-typography gds-heading gds-heading-medium")};case y.M_.Type.header2:return{icon:m.i,tooltip:O(e,"gds-typography gds-heading gds-heading-small")};case y.M_.Type.link:return{icon:p.c,tooltip:O(e,M.link)};case y.M_.Type.bulletList:return{icon:h.W,tooltip:O(e)};case y.M_.Type.orderedList:return{icon:g.h,tooltip:O(e)};case"clear":return{icon:_.j,tooltip:O(e)};default:return(0,f.xb)(e.name)}}},52680:(e,t,i)=>{i.d(t,{J:()=>r});var s=i(85886),n=i(74056),a=i(93712),o=i(22068);const r=()=>{const e=(0,n.W$)(new a.Qt).base.byokErrorPage;return s.createElement(o.M,{title:e.title,description:e.description()})}}}]);