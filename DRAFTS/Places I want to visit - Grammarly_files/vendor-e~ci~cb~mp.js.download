"use strict";(self.webpackChunk_grammarly_denali_app=self.webpackChunk_grammarly_denali_app||[]).push([[3321],{41425:(e,t,i)=>{i.d(t,{m:()=>Q,Q:()=>z});var s=i(23988),o=i(10334),n=i(17171),r=i(85886),a=i(65390),l=i(84647),h=i(34553),d=i(83407),p=i(24819),c=i(56855),_=i(80843),u=i(84712),v=i(99010),m=i(75248),b=i(83694),y=i(84872),g=i(48779),w=i(7149),C=i(31206),E=i(79937),f=i(25093),x=i(9079),k=i(60191),F=i(57836),D=i(79),A=i(58655),M=i(21644),P=i(30343),S=i(30595),K=i(96011),T=i(97390),$=i(21476),B=i(35098),H=i(19772),L=i(27199),R=i(11864),N=i(13607);const V={position:"absolute",zIndex:N.yg,display:"flex",flexDirection:"column",margin:`${R.Ks.rem(.5)} 0`,padding:`${R.Ks.rem(.5)} 0`,minWidth:R.Ks.percent(100),borderRadius:R.Ks.rem(N.Am),background:L.Q1.CoreNeutral0,boxShadow:L.eu.Z200,opacity:1,transition:"opacity .2s"},W={margin:R.Ks.rem(.5),height:R.Ks.px(1),backgroundColor:L.Q1.CoreNeutral20},I={wrapper:R.Ks.style({position:"relative"}),list:R.Ks.style(V),transparent:R.Ks.style({opacity:0}),hidden:R.Ks.style({display:"none"}),delimiter:R.Ks.style(W)};class O extends K.kp{}class Q extends r.PureComponent{_getHAlign(e){switch(e){case"left":case"auto":return{left:"0"};case"right":return{right:"0"};case"center":return{right:"50%",marginRight:`-${(this._dropdownEl?this._dropdownEl.offsetWidth:0)/2}px`};default:return(0,p.xb)(e)}}_getVAlign(e){switch(e){case"top":return{bottom:"100%"};case"bottom":case"auto":return{top:"100%"};default:return(0,p.xb)(e)}}calcDropdownPosition(){const e=this.props.align,t=this.props.vAlign;this._listPosState.set((0,o._)({},this._getHAlign(e),this._getVAlign(t)));const i="auto"===e,s="auto"===t;(i||s)&&requestAnimationFrame((()=>{if(this._dropdownEl){const n=this._viewport.get(),r=this._dropdownEl.getBoundingClientRect();this._listPosState.set((0,o._)({},this._getHAlign(i?n.right<r.right?"right":"left":e),this._getVAlign(s?n.bottom<r.bottom?"top":"bottom":t)))}}))}componentDidMount(){this._subs.push(this.hovered.pipe(v.M((e=>{this.props.onVisibilityChange&&this.props.onVisibilityChange(e)})),m.K((0,l.pipe)(a.fromNullable(this.props.customPosition),a.fold((()=>b.of(a.none)),(({top:e,left:t})=>y.z(g.br(e),g.br(t)).pipe(w.T(a.some))))))).subscribe(a.fold((()=>this.calcDropdownPosition()),(([e,t])=>this._listPosState.set({top:e,left:t})))),this.context.pipe(C.E("rect")).subscribe(g.H9(this._viewport))),this.props.forceHide&&this._subs.push(this._hidden.pipe(E.n(g.$x(this.props.forceHide.pipe(f.$())))).subscribe((()=>this._hidden.set(!0))))}componentWillUnmount(){this._subs.forEach((e=>e.unsubscribe())),this._subs=[]}UNSAFE_componentWillReceiveProps(){this.calcDropdownPosition()}mapStateToClass(e,t){const i={start:"",end:""};return t?{prev:i,next:{start:I.transparent,end:""}}:{prev:{start:"",end:I.transparent},next:i}}_behavior(e){return"mouseClick"===this.props.appearanceBehavior?{onClickCapture:t=>this._handleClickForAppearanceClick(t,e),onMouseEnter:this._handleMouseEnterForAppearanceClick,onMouseLeave:()=>this._hovered.set(this._initialState)}:{onClickCapture:this._handleClickForAppearanceHover,onMouseEnter:this._handleMouseEnterForAppearanceHover,onMouseLeave:()=>this._hovered.set(this._initialState)}}_labelBehavior(){return{onKeyDown:this._handleLabelKeyDownForAppearance}}_attachDropdownElementBehavior(){var e;null===(e=this._dropdownEl)||void 0===e||e.addEventListener("keydown",(e=>{var t;"Escape"===e.key&&(this._hovered.set(this._initialState),e.preventDefault(),e.stopPropagation(),(null===(t=this._labelRef.current)||void 0===t?void 0:t.firstChild)&&setTimeout((()=>{var e,t;return null===(e=null===(t=this._labelRef.current)||void 0===t?void 0:t.firstChild)||void 0===e?void 0:e.focus()}),0))}))}_handleDropdownElementMount(e){this._dropdownEl=e,this._attachDropdownElementBehavior()}render(){const{label:e,id:t,name:i,ariaLabelledBy:s,theme:a={}}=this.props,h=Boolean(t)?`label-${i}-${t}`:`label-${i}`,d=Boolean(t)?`list-${i}-${t}`:`list-${i}`;return r.createElement($.f.Context.Consumer,null,(t=>r.createElement(T.e.Context.Consumer,null,(i=>r.createElement(T.e.Context.Provider,{value:T.e.withValue(i,{hovered:this._hovered})},r.createElement(c.F.div,(0,n._)((0,o._)({role:"combobox"},(0,_.Ly)(I.wrapper,a.dropdownContainer),this._behavior(t.has($.f.Flag.onlyTrustedEvents))),{"aria-haspopup":"listbox","aria-labelledby":null!=s?s:h,"aria-expanded":g.B8(this._hidden),"aria-controls":d}),r.createElement("label",(0,n._)((0,o._)({id:h},this._labelBehavior()),{ref:this._labelRef}),e),r.createElement(O,{state:this.hovered,stateToClassMapper:this.mapStateToClass},(e=>e.state?r.createElement(c.F.div,null,this._hidden.view((t=>r.createElement(z,(0,n._)((0,o._)({id:d,key:"list",name:this.props.name,onTransitionEnd:"prev"===e.type?()=>this._hidden.set(!0):l.constVoid},(0,_.Ly)(a.dropdownList,e.view)),{mount:this._handleDropdownElementMount.bind(this),style:this._listPosState,hidden:t,activeDescendantId:this.props.activeDescendantId}),this.props.children)))):null))))))))}constructor(...e){super(...e),(0,s._)(this,"context",void 0),(0,s._)(this,"_uuid",(0,S.G7)(12)),(0,s._)(this,"_initialState",!1),(0,s._)(this,"_hovered",u.s.create(this._initialState)),(0,s._)(this,"_hidden",u.s.create(!this._initialState)),(0,s._)(this,"_listPosState",u.s.create({})),(0,s._)(this,"_dropdownEl",null),(0,s._)(this,"_subs",[]),(0,s._)(this,"_viewport",u.s.create(d.rw.empty)),(0,s._)(this,"_labelRef",r.createRef()),(0,s._)(this,"hovered",this._hovered.pipe(x.J(),E.n((([e,t])=>t?k.O1(this.props.showDelay).pipe(F.u(!0)):e?k.O1(void 0===this.props.closeDelay?Q.defaultProps.closeDelay:this.props.closeDelay).pipe(F.u(!1)):b.of(!1))),D.h(Q._hoveredForce.pipe(w.T(a.exists((e=>e===this._uuid))))),A.F(),v.M((e=>e&&Q._hoveredForce.next(a.some(this._uuid)))),v.M((e=>e&&this._hidden.set(!1))),M.u(),P.Z(this._initialState))),(0,s._)(this,"_handleClickForAppearanceHover",(e=>{const t=e.target;if((0,d.d6)(t)||!0===this.props.dontCloseOnClickInside)return;const i=!(0,d.ws)(t,I.list);Q._hoveredForce.next(i?a.some(this._uuid):a.none),this._hovered.set(i)})),(0,s._)(this,"_handleMouseEnterForAppearanceHover",(()=>{this._hovered.set(!0)})),(0,s._)(this,"_handleClickForAppearanceClick",((e,t)=>{t&&!e.isTrusted||(this._hovered.get()?this._handleClickForAppearanceHover(e):this._hovered.set(!0))})),(0,s._)(this,"_handleMouseEnterForAppearanceClick",(e=>{const t=e.target;(0,d.ws)(t,I.list)&&(Q._hoveredForce.next(a.some(this._uuid)),this._hovered.set(!0))})),(0,s._)(this,"_handleLabelKeyDownForAppearance",(e=>{"Enter"!==e.key&&" "!==e.key||(this._hovered.set(!0),e.preventDefault())}))}}(0,s._)(Q,"defaultProps",{align:"auto",vAlign:"auto",showDelay:500,closeDelay:500,appearanceBehavior:"mouseHover"}),(0,s._)(Q,"Delimiter",(()=>r.createElement("div",{className:I.delimiter}))),(0,s._)(Q,"_hoveredForce",new h.B),(0,s._)(Q,"contextType",B.L.Context);const z=e=>{const{ref:t,onMount:i}=H.R.useElWatcher();return H.R.FocusTrap.useFocusTrap(t),r.createElement(T.e.Context.Consumer,null,(t=>{const s=T.e.emptyWithName(`${void 0!==t.name?`${t.name}/`:""}dropdown-${e.name}`);return r.createElement(T.e.Context.Provider,{value:s},r.createElement(c.F.div,(0,n._)((0,o._)({id:e.id},(0,_.Ly)(e.className,!0===e.hidden?I.hidden:I.list)),{style:e.style,mount:t=>{i(t),void 0!==e.mount&&e.mount(t)},role:"listbox","aria-labelledby":e.ariaLabelledBy,"data-role":"dropdown-list","data-name":"dropdown-"+e.name,"aria-activedescendant":e.activeDescendantId,onTransitionEnd:e.onTransitionEnd}),e.children))}))}}}]);